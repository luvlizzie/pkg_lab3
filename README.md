# Обработка изображений с использованием OpenCV.js

## Описание
Веб-приложение предназначено для загрузки и обработки изображений прямо в браузере с использованием библиотеки компьютерного зрения OpenCV.js. Пользователь может применять различные алгоритмы фильтрации и пороговой обработки без установки дополнительного программного обеспечения. Все операции выполняются на стороне клиента с использованием OpenCV.js, Canvas API и JavaScript.

## Возможности

### Загрузка и отображение
- Поддержка форматов: JPG, JPEG, PNG, BMP, GIF, WEBP
- Отображение оригинального и обработанного изображений
- Автоматическое масштабирование под размер окна

### Базовые операции с изображениями (OpenCV.js)
- **Инверсия (Negative)** - преобразование в негатив с помощью `cv.bitwise_not()`
- **Коррекция яркости** - аддитивное изменение яркости через `cv.convertScaleAbs()`
- **Коррекция контраста** - мультипликативное изменение контраста через `cv.convertScaleAbs()`
- **Линейное контрастирование** - автоматическое растяжение гистограммы с использованием `cv.normalize()`

### Алгоритмы пороговой обработки (OpenCV.js)
- **Локальный порог (Mean)** - адаптивная бинаризация на основе локального среднего через `cv.adaptiveThreshold(ADAPTIVE_THRESH_MEAN_C)`
- **Локальный порог (Gaussian)** - адаптивная бинаризация на основе гауссова среднего через `cv.adaptiveThreshold(ADAPTIVE_THRESH_GAUSSIAN_C)`
- **Адаптивная пороговая обработка** - интеллектуальная бинаризация с учетом локальных особенностей изображения

### Интерфейс и управление
- Динамический интерфейс параметров для каждого метода OpenCV
- Индикатор загрузки OpenCV.js
- Генерация тестовых изображений для экспериментов
- Скачивание результатов обработки
- Адаптивный дизайн для различных устройств

## Технологии

- **HTML5** — семантическая структура веб-страницы, элементы Canvas
- **CSS3** — современное оформление с CSS Grid, Flexbox, анимациями
- **JavaScript (ES6+)** — модульная архитектура, асинхронные операции
- **OpenCV.js 4.5.5** — библиотека компьютерного зрения для браузера
- **Canvas API** — низкоуровневый доступ к пиксельным данным
- **File API** — работа с локальными файлами пользователя

## Архитектура приложения

### Загрузка и подготовка изображений
```javascript
function loadImageIntoCanvas(img) { 
    originalImage = img; 
    fitCanvasToImage(img, origCanvas); 
    fitCanvasToImage(img, outCanvas); 
    originalImageData = oc.getImageData(0,0,origCanvas.width, origCanvas.height); 
}
```

### Система обработки изображений OpenCV
```javascript
// Базовые операции (OpenCV.js)
function applyOpenCVFilter(imageData, filterType, params) {
    const src = imageDataToMat(imageData);
    const srcBGR = new cv.Mat();
    cv.cvtColor(src, srcBGR, cv.COLOR_RGBA2BGR);
    
    switch(filterType) {
        case 'cv_negative':
            cv.bitwise_not(srcBGR, dst);
            break;
        case 'cv_brightness':
            cv.convertScaleAbs(srcBGR, dst, 1, params.offset);
            break;
        case 'cv_contrast':
            cv.convertScaleAbs(srcBGR, dst, params.factor, 0);
            break;
    }
}
```

### Управление интерфейсом
- Динамическое создание элементов управления для методов OpenCV
- Валидация параметров
- Обработка пользовательского ввода
- Управление состоянием загрузки OpenCV.js

## Алгоритмы обработки OpenCV.js

### Поэлементные операции
```javascript
// Яркость
cv.convertScaleAbs(srcBGR, dst, 1, offset);

// Контраст
cv.convertScaleAbs(srcBGR, dst, factor, 0);

// Инверсия
cv.bitwise_not(srcBGR, dst);

// Линейное контрастирование
cv.normalize(srcBGR, dst, 0, 255, cv.NORM_MINMAX);
```

### Адаптивная пороговая обработка
```javascript
// Локальный порог (Mean)
cv.adaptiveThreshold(gray, dst, 255, cv.ADAPTIVE_THRESH_MEAN_C, 
                    cv.THRESH_BINARY, blockSize, C);

// Локальный порог (Gaussian)
cv.adaptiveThreshold(gray, dst, 255, cv.ADAPTIVE_THRESH_GAUSSIAN_C,
                    cv.THRESH_BINARY, blockSize, C);
```

## Как это работает

### Инициализация OpenCV.js
- Библиотека загружается локально из файла opencv.js
- После загрузки активируются все методы OpenCV в интерфейсе
- Статус загрузки отображается в реальном времени

### Загрузка изображения
- Пользователь выбирает файл через `<input type="file">`
- Изображение загружается в память через URL.createObjectURL()
- Данные передаются на Canvas для обработки

### Выбор метода обработки
- Пользователь выбирает алгоритм OpenCV из выпадающего списка
- Динамически генерируются соответствующие параметры управления
- Параметры валидируются и настраиваются

### Применение алгоритма
```javascript
function applySelected() {
    const method = methodSel.value;
    
    if (method.startsWith('cv_')) {
        const params = {};
        // Настройка параметров для выбранного метода OpenCV
        resultImageData = applyOpenCVFilter(originalImageData, method, params);
    }
}
```

### Визуализация результата
- Обработанное изображение отображается на втором Canvas
- Обновляется мета-информация о размерах
- Предоставляется возможность скачать результат

## Структура проекта
```
project/
├── index.html          # Основная структура интерфейса
├── styles.css          # Стили оформления (осенняя тема)
├── script.js           # Логика обработки с OpenCV.js
├── opencv.js           # Библиотека OpenCV.js (8.6 MB)
└── autumn.jpeg         # Фоновое изображение
```

## Компоненты интерфейса
- **Левая панель** - управление методами OpenCV, индикатор загрузки
- **Правая панель** - предпросмотр оригинального и обработанного изображений
- **Динамические параметры** - настройки для каждого алгоритма OpenCV

## Пример использования

### Запуск приложения
1. Открыть index.html в современном браузере
2. Дождаться загрузки OpenCV.js (индикатор "✅ OpenCV.js загружен!")
3. Начать работу с интерфейсом

### Загрузка изображения
1. Нажать "Загрузить изображение"
2. Выбрать файл с компьютера
3. Наблюдать загрузку в левый Canvas

### Выбор метода обработки
1. Выбрать метод OpenCV из выпадающего списка
2. Настроить параметры (яркость, контраст, размер блока и т.д.)
3. Нажать "Применить"

### Анализ результатов
1. Сравнить оригинал и результат на правой панели
2. При необходимости настроить параметры и повторить
3. Скачать результат через "Скачать"

### Эксперименты с тестовыми изображениями
1. Нажать "Тестовые изображения"
2. Выбрать один из предустановленных шаблонов
3. Протестировать различные алгоритмы OpenCV

## Особенности реализации

### Производительность
- Использование оптимизированных алгоритмов OpenCV.js
- Эффективное управление памятью с освобождением матриц
- Пакетная обработка больших изображений

### Точность
- Реализация промышленных стандартов компьютерного зрения
- Корректная обработка граничных случаев
- Точные математические вычисления

### Пользовательский опыт
- Интуитивный интерфейс с осенней цветовой схемой
- Мгновенная обратная связь при изменениях
- Визуальные эффекты при наведении

## Преимущества

- **Профессиональные алгоритмы** - использование библиотеки OpenCV.js
- **Полная клиентская реализация** - не требует серверной части
- **Кроссплатформенность** - работает в любом современном браузере
- **Производительность** - оптимизированные алгоритмы обработки
- **Образовательная ценность** - наглядная демонстрация алгоритмов компьютерного зрения
- **Практическая польза** - может использоваться для реальной обработки изображений

## Вывод
Разработанное веб-приложение успешно интегрирует библиотеку OpenCV.js для реализации комплексной обработки изображений. Приложение предоставляет удобный интерфейс для экспериментов с различными алгоритмами компьютерного зрения и демонстрирует эффективность клиентских веб-технологий для решения задач обработки изображений. Использование OpenCV.js обеспечивает профессиональное качество результатов обработки, сопоставимое с desktop-приложениями.
